{
  "description": "Recon test fixtures for offline validation of CDN/WAF detection",
  "fixtures": [
    {
      "id": "cloudflare_challenge",
      "name": "Cloudflare Browser Challenge",
      "html_file": "cloudflare_challenge.html",
      "headers": {
        "server": "cloudflare",
        "cf-ray": "8a1b2c3d4e5f6g7h-IAD",
        "cf-cache-status": "DYNAMIC"
      },
      "status_code": 403,
      "expected": {
        "cdn": "cloudflare",
        "challenge_type": "cf-challenge",
        "js_required": true,
        "recommended_method": "stealth"
      }
    },
    {
      "id": "cloudflare_pass",
      "name": "Cloudflare (No Challenge)",
      "html_file": "cloudflare_pass.html",
      "headers": {
        "server": "cloudflare",
        "cf-ray": "8a1b2c3d4e5f6g7h-IAD",
        "cf-cache-status": "HIT"
      },
      "status_code": 200,
      "expected": {
        "cdn": "cloudflare",
        "challenge_type": null,
        "js_required": false,
        "recommended_method": "js"
      }
    },
    {
      "id": "stackpath_sgcaptcha",
      "name": "StackPath sgcaptcha Challenge",
      "html_file": "stackpath_sgcaptcha.html",
      "headers": {
        "server": "nginx",
        "sg-captcha": "challenge",
        "x-cdn": "stackpath"
      },
      "status_code": 202,
      "expected": {
        "cdn": "stackpath",
        "challenge_type": "sgcaptcha",
        "js_required": true,
        "recommended_method": "stealth+cookies"
      }
    },
    {
      "id": "akamai_bot_manager",
      "name": "Akamai Bot Manager",
      "html_file": "akamai_bot_manager.html",
      "headers": {
        "server": "AkamaiGHost",
        "x-akamai-transformed": "9 - 0 pmb=mRUM,3"
      },
      "status_code": 403,
      "expected": {
        "cdn": "akamai",
        "challenge_type": "bot-manager",
        "js_required": true,
        "recommended_method": "stealth"
      }
    },
    {
      "id": "fastly_pass",
      "name": "Fastly CDN (No Protection)",
      "html_file": "fastly_pass.html",
      "headers": {
        "server": "nginx",
        "x-served-by": "cache-iad-kiad7000162-IAD",
        "x-cache": "HIT",
        "x-fastly-request-id": "abc123"
      },
      "status_code": 200,
      "expected": {
        "cdn": "fastly",
        "challenge_type": null,
        "js_required": false,
        "recommended_method": "http"
      }
    },
    {
      "id": "no_protection",
      "name": "Plain Site (No CDN/WAF)",
      "html_file": "no_protection.html",
      "headers": {
        "server": "Apache/2.4.41"
      },
      "status_code": 200,
      "expected": {
        "cdn": null,
        "challenge_type": null,
        "js_required": false,
        "recommended_method": "http"
      }
    },
    {
      "id": "js_spa_react",
      "name": "React SPA (JS Required)",
      "html_file": "js_spa_react.html",
      "headers": {
        "server": "nginx"
      },
      "status_code": 200,
      "expected": {
        "cdn": null,
        "challenge_type": null,
        "js_required": true,
        "recommended_method": "js"
      }
    },
    {
      "id": "js_nextjs",
      "name": "Next.js Site",
      "html_file": "js_nextjs.html",
      "headers": {
        "server": "Vercel",
        "x-vercel-id": "iad1::abc123"
      },
      "status_code": 200,
      "expected": {
        "cdn": "vercel",
        "challenge_type": null,
        "js_required": true,
        "recommended_method": "js"
      }
    },
    {
      "id": "aem_site",
      "name": "Adobe Experience Manager",
      "html_file": "aem_site.html",
      "headers": {
        "server": "Apache",
        "x-dispatcher": "dispatcher1useast1"
      },
      "status_code": 200,
      "expected": {
        "cdn": null,
        "challenge_type": null,
        "js_required": true,
        "recommended_method": "js"
      }
    },
    {
      "id": "noscript_warning",
      "name": "Site with Noscript Warning",
      "html_file": "noscript_warning.html",
      "headers": {
        "server": "nginx"
      },
      "status_code": 200,
      "expected": {
        "cdn": null,
        "challenge_type": null,
        "js_required": true,
        "recommended_method": "js"
      }
    }
  ]
}
